# Windows 控制台俄罗斯方块游戏实现说明

## 游戏概述
这是一个基于 Windows 控制台的俄罗斯方块游戏实现。游戏使用 C 语言编写，利用 Windows API 实现了彩色显示、键盘控制和平滑的游戏体验。

## 核心实现思路

### 1. 游戏数据结构
- 使用二维数组表示游戏区域 (`board[HEIGHT][WIDTH]`)
- 使用二维数组存储方块形状 (`PIECES[7][4][4]`)
- 记录当前方块的位置和类型
- 维护下一个方块的类型信息

### 2. 控制台处理
- 使用 Windows Console API 进行控制台初始化
- 设置控制台缓冲区和窗口大小
- 隐藏光标提升视觉体验
- 使用 UTF-8 编码支持特殊字符

### 3. 游戏渲染
- 采用直接控制台输出方式，避免闪烁
- 使用 `SetConsoleCursorPosition` 实现精确定位
- 通过 `SetConsoleTextAttribute` 控制颜色
- 实现游戏区域和预览区域的分离显示

### 4. 方块控制
- 实现方块的四种基本操作：
  - 左右移动：检查边界和碰撞
  - 旋转：90度顺时针旋转并检查有效性
  - 加速下落：通过修改更新频率实现
  - 自动下落：基于计时器实现

### 5. 碰撞检测
- 实现 `canMove` 函数检查移动有效性
- 检查边界碰撞
- 检查与其他方块的碰撞
- 在旋转时进行碰撞检测

### 6. 消行处理
- 检查每一行是否已满
- 消除已满的行
- 上方方块下移
- 更新分数

### 7. 输入处理
- 使用 `_kbhit` 和 `_getch` 实现非阻塞键盘输入
- 使用 `GetAsyncKeyState` 实现持续按键检测（用于加速下落）
- 支持以下按键操作：
  - ←→：左右移动
  - ↑：旋转
  - ↓：加速下落
  - ESC：退出游戏

### 8. 游戏循环
1. 初始化游戏环境
2. 进入主循环：
   - 处理键盘输入
   - 更新游戏状态
   - 检查碰撞
   - 处理消行
   - 渲染画面
   - 控制游戏速度

### 9. 性能优化
- 优化渲染逻辑，减少屏幕刷新
- 使用适当的游戏循环延时
- 高效的碰撞检测算法

## 编译说明
使用支持 Windows API 的 C 编译器编译（如 gcc、zig 等）。需要链接 Windows 系统库。

## 控制说明
- ←→：左右移动方块
- ↑：旋转方块
- ↓：加速下落（按住持续加速）
- ESC：退出游戏

## 游戏特性
- 彩色显示
- 下一个方块预览
- 分数统计
- 平滑的控制体验
- 完整的游戏边框
- 持续加速功能
